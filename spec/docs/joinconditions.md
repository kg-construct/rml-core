# Joins

A [=Referencing Object Map=] allows using the subject generated by the [=Subject Map=] (`rml:SubjectMap`) of the referenced [=Triples Map=] (`rml:TriplesMap`).
Since the two [=triples maps=] may be based on different [=logical sources=] (`rml:LogicalSource`), this may require a [=join=] (`rml:Join`) between the [=logical sources=]. This is not restricted to 1:1 joins.

## Referencing Object Map

A <dfn>Referencing Object Map</dfn> (`rml:ReferencingObjectMap`) is represented by a resource that:

* has exactly one [=parent triples map=] (`rml:parentTriplesMap`) property,
  whose value MUST be a [=triples map=], known as the referencing object map's <dfn>parent triples map</dfn>.
* MUST have one or more [=join Conditions=] (`rml:joinCondition`) properties.

The [=referencing object map=] caused the generation of new [=object=] which is constructed with the [=subject=] generated by evaluating the [=parent triples map=].

<aside class="example" id="example-referencing-object-map" title="usage of referencing object map">

<aside class="ex-mapping">

```turtle
<#TM1>
  rml:logicalSource <#LS1> ;
  rml:subjectMap <#SM1> ;
  rml:predicateObjectMap [
    rml:predicateMap <#PM1> ;
    rml:objectMap [
      rml:parentTriplesMap <#TM2> ;
    ] ;
  ] .

<#TM2>
  rml:logicalSource <#LS2> ;
  rml:subjectMap <#SM2> ;
  rml:predicateObjectMap [
    rml:predicateMap <#PM2> ;
    rml:objectMap <#OM2> ;
  ] .
```

</aside>

</aside>

## Join Condition

A <dfn>Join Condition</dfn> is represented by a resource that has exactly one value for each of the following two properties:

* a child map (`rml:childMap`) property, whose value is a [=child map=]. A <dfn>child map</dfn> (`rml:ChildMap`) is an [=expression map=], which MUST include [=references=] that exist in the [=logical source=] of the [=parent triples map=] that contains the [=referencing object map=], or it should have a [=constant value=].

* a parent map (`rml:parentMap`) property, whose value is a [=parent map=]. A <dfn>parent map</dfn> (`rml:ParentMap`) is an [=expression map=], which MUST include references that exist in the [=logical source=] of the [=referencing object map=]'s [=parent triples map=], or it should have a [=constant value=].

<aside class="example" id="example-join-condition" title="usage of join condition">

<aside class="ex-mapping">

```turtle
<#TM1>
  rml:logicalSource <#LS1> ;
  rml:subjectMap <#SM1> ;
  rml:predicateObjectMap [
    rml:predicateMap <#PM1> ;
    rml:objectMap [
      rml:parentTriplesMap <#TM2> ;
      rml:joinCondition [
        rml:childMap [ rml:reference "..."] ;
        rml:parentMap [ rml:template "..."] ;
      ] ;
    ] ;
  ] .

<#TM2>
  rml:logicalSource <#LS2> ;
  rml:subjectMap <#SM2> .
```

</aside>

</aside>

### Shortcuts for reference-valued child map and parent map

If the [=child map=] is a [=reference-valued expression map=], then the `rml:child` shortcut could be used.

Similarly, if the [=parent map=] is a [=reference-valued expression map=], then the `rml:parent` shortcut could be used.

Occurrences of these properties MUST be treated exactly as if the following triples were present in the [=mapping graph=] instead:

| Triple involving reference shortcut property | Replacement triples                      |
| :--------------------------------------------| :----------------------------------------|
| `?x rml:child ?y.`                           | `?x rml:childMap [ rml:reference ?y ].`  |
| `?x rml:parent ?y.`                          | `?x rml:parentMap [ rml:reference ?y ].` |


<aside class="example" id="example-join-condition-shortcut-properties" title="usage of shortcut properties for child map and parent map">

<aside class="ex-mapping">

```turtle
<#TM1>
  rml:logicalSource <#LS1> ;
  rml:subjectMap <#SM1> ;
  rml:predicateObjectMap [
    rml:predicateMap <#PM1> ;
    rml:objectMap [
      rml:parentTriplesMap <#TM2> ;
      rml:joinCondition [
        rml:child "..." ;
        rml:parent "..." ;
      ] ;
    ] ;
  ] .

<#TM2>
  rml:logicalSource <#LS2> ;
  rml:subjectMap <#SM2> .
```

</aside>

</aside>
