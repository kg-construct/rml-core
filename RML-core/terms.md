# Terms

## Term map (`rml:TermMap`)

A <dfn>term map</dfn> (`rml:TermMap`) is an [=expression map=]...

... <dfn>term type</dfn> ...

<aside class="issue">
(incorporate the following text as a note somewhere in this paragraph:)

NOTE: on constant expressions

[=Constant expressions=] are only allowed to be IRIs and literals. Blank nodes are explicitly not allowed. The reason for this is that blank node identifiers are always locally scoped to the file or RDF store, and are _not_ persistent or portable identifiers [[rdf11-concepts-20140225]]. This means that they cannot be used as a constant expression, since the idea of a [=constant expression=] is to use that same [=constant value=] as the result of a mapping process. By definition, a blank node identifier cannot be ported from a mapping document to a mapping result.
</aside>

<aside class="issue">
(incorporate the following text from r2rml templates somewhere:)

; or in the IRI-safe versions of the data values, if the term type is rr:IRI (see note below)
</aside>

## Datatypes (`rml:datatypeMap` and `rr:datatype`)

A <dfn>datatypeable term map</dfn> is a [=term map=] with a [=term type=] of `rr:Literal` that does not have a [specified language map](#language-tags-rml-languagemap-and-rr-language).

[=Datatypeable term maps=] MAY generate typed literals. The datatype of these literals MAY be [automatically determined](#automatically-deriving-datatypes), or it MAY be explicitly specified using a [=datatype map=].

A <dfn>datatype map</dfn> (`rml:DatatypeMap`) is an [=expression map=]. It specifies a rule for generating one or more datatypes of a [=datatypeable term map=]. A [=datatype map=] MUST generate a list of IRI values, in which the IRIs are the datatypes of the [=datatypeable term map=].

Given the list of values resulting from a [=datatypeable term map=] `T`, and the list of values resulting from its [=datatype map=] `D`, the resulting terms are generated by the [=n-ary Cartesian product=] combination of `T × D`, where the values in `T` are the literal values, and the values in `D` are the datatype IRIs.

<div class="issue">
  <p>Can a term map have more than one datatype map? This is related to the multiple values discussion.</p>
</div>

```turtle "example": "usage of datatype map"
[] rr:objectMap [
  rml:reference "value" ;
  rml:languageMap [
    rr:template "http://www.w3.org/2001/XMLSchema#{datatype}" ;
  ] ;
] .
```

A [=datatypeable term map=] MAY have zero or more [=datatype maps=], which can be specified in two ways:
1. using the `rml:datatypeMap` property, whose value MUST be a [=datatype map=], or
2. using the [=constant shortcut property=] `rr:datatype`.

 Usage of `rr:datatype`

```turtle "example": "constant shortcut property rr:datatype"
?x rr:datatype ?y .
```

leads to the following replacement triples.

```turtle "example": "replacement triples for rr:datatype"
?x rml:datatypeMap [
  rr:constant ?y ;
] .
```

### Automatically deriving datatypes


## Language tags (`rml:languageMap` and `rr:language`)

A <dfn>language-taggable term map</dfn> is a [=term map=] with a [=term type=] of `rr:Literal` that does not have a [specified datatype map](#datatypes-rml-datatypemap-and-rr-datatype).

<div class=issue>
  <p>Do we want to state the exception for datatype `rdf:langString`?</p>
</div>

A [=language-taggable term map=] MAY be associated with a [=language map=].

A <dfn>language map</dfn> (`rml:LanguageMap`) is an [=expression map=]. It specifies a rule for generating one or more [language tags](https://www.w3.org/TR/rdf11-concepts/#dfn-language-tag) for a [=language-taggable term map=]. Following [[rdf11-concepts-20140225]], the generated language tags MUST be well-formed according to [[BCP47]].

Given the list of values resulting from a [=language-taggable term map=] `T`, and the list of values resulting from its [=language map=] `L`, the resulting terms are generated by the [=n-ary Cartesian product=] combination of `T × L`, where the values in `T` are the [lexical forms](https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form), and the values in `L` are the non-empty language tags.

Each combination of `T × L` causes the generation of a language-tagged plain literal.

In the following example the lexical form values generated by reference `"Localization"` are combined with the well-formed language tag values from reference `"Localization[@Culture]"` to generate a list of language tagged literals.

```turtle "example": "usage of language map"
[] rr:objectMap [
  rml:reference "Localization" ;
  rml:languageMap [
    rml:reference "Localization[@Culture]" ;
  ] ;
] .
```

A language tag MAY also be specified using [=constant shortcut property=] `rr:language`. Usage of `rr:language`

```turtle "example": "constant shortcut property rr:language"
?x rr:language ?y .
```

leads to the following replacement triples.

```turtle "example": "replacement triples for rr:language"
?x rml:languageMap [
  rr:constant ?y ;
] .
```
